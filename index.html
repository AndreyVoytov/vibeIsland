<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Mini-Game</title>
  <style>
    :root{ --game-width:100vw; }
    html,body{ margin:0; height:100%; overflow:hidden; background:#000; }

    #gameWrapper{
      position:absolute;
      top:0; left:50%;
      transform:translateX(-50%);
      width:var(--game-width);
      height:100%;
      overflow:hidden;
    }

    .layer{
      position:absolute; top:0; left:0;
      width:100%; height:100%; border:0;
    }
    #mapLayer        { z-index:0; display:none; }
    #seaLayer        { z-index:1; }
    #islandLayer     { z-index:2; }
    #buildingsLayer  { z-index:3; }
    #berriesLayer    { z-index:4; }
    #heroLayer       { z-index:5; background:transparent; }
    #heroLogicLayer  { z-index:5; width:0; height:0; pointer-events:none; } /* логика, невидима */
    #controllerLayer { z-index:6; background:transparent; }
    #uiLayer         { z-index:7; background:transparent; }
  </style>
</head>
<body>
  <div id="gameWrapper">
    <iframe id="mapLayer"        class="layer"></iframe>
    <iframe id="seaLayer"        class="layer"></iframe>
    <iframe id="islandLayer"     class="layer"></iframe>
    <iframe id="buildingsLayer"  class="layer"></iframe>
    <iframe id="berriesLayer"    class="layer"></iframe>
    <iframe id="heroLayer"       class="layer"></iframe>
    <iframe id="heroLogicLayer"  class="layer"></iframe>
    <iframe id="controllerLayer" class="layer"></iframe>
    <iframe id="uiLayer"         class="layer"></iframe>
  </div>

  <script>
    /* — портретная ширина — */
    function setGameWidth(){
      const vw = innerWidth, vh = innerHeight, pr = 9/16;
      const gameW = (vw > vh) ? Math.floor(vh * pr) : vw;
	  const gameH = (vw > vh) ? vh : Math.floor(gameW / pr);
	  localStorage.setItem('gameWidth', gameW);
	  localStorage.setItem('gameHeight', gameH);
	  console.log('gameWidth: ' + gameW + '; gameHeight: ' + gameH); 

      document.documentElement.style.setProperty('--game-width', `${gameW}px`);
    }
    setGameWidth(); addEventListener('resize', setGameWidth);

    /* — каскад загрузки — */
    const mapFrame = document.getElementById('mapLayer');
    mapFrame.src = 'map.html';
    mapFrame.onload = () => {
      document.getElementById('seaLayer').src         = 'layoutSea.html';
      document.getElementById('islandLayer').src      = 'layoutIsland.html';
      document.getElementById('buildingsLayer').src   = 'buildings.html';
      document.getElementById('berriesLayer').src     = 'berries.html';
      document.getElementById('heroLayer').src        = 'heroAnimation.html';
      document.getElementById('heroLogicLayer').src   = 'hero.html';
      document.getElementById('controllerLayer').src  = 'controller.html';
      document.getElementById('uiLayer').src          = 'ui.html';
    };
  </script>
</body>
</html>
