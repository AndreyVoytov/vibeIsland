<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Map Init</title>
</head>
<body>
<script>
/* стартовая карта с запасом воды вокруг острова */
const MAP_WIDTH = 25;
const MAP_HEIGHT =25;
const ISLAND_SIZE = 18;
const startX = Math.floor((MAP_WIDTH - ISLAND_SIZE) / 2);
const startY = Math.floor((MAP_HEIGHT - ISLAND_SIZE) / 2);

const defaultMap = Array.from({ length: MAP_HEIGHT }, (_, y) =>
  Array.from({ length: MAP_WIDTH }, (_, x) =>
    (x >= startX && x < startX + ISLAND_SIZE && y >= startY && y < startY + ISLAND_SIZE) ? 1 : 0
  )
);

const existingMap = localStorage.getItem('map');
if(!existingMap || existingMap === '[]'){
  localStorage.setItem('map', JSON.stringify(defaultMap));
}
const baseGridW = Number(localStorage.getItem('baseGridW') || '0');
if(!Number.isFinite(baseGridW) || baseGridW <= 0){
  const current = JSON.parse(localStorage.getItem('map') || '[]');
  const gridW = current[0]?.length || 0;
  if(gridW){
    localStorage.setItem('baseGridW', String(gridW));
  }
}
</script>
</body>
</html>
